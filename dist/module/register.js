"use strict";window.onload=function(){console.log(document.cookie),console.log(1);var s=document.getElementById("txt"),l=document.getElementById("txt3"),e=document.getElementById("txt4"),t=document.getElementsByClassName("aa"),r=[!1,!1,!1],n=document.getElementsByTagName("form")[0],c=document.getElementById("checkCard"),o=document.getElementById("cont"),a=document.getElementById("change"),u=d();function i(){var e,t,n;switch(parseInt(3*Math.random())){case 0:return n=parseInt(10*Math.random())+48,String.fromCharCode(n);case 1:return t=parseInt(26*Math.random())+97,String.fromCharCode(t);case 2:return e=parseInt(26*Math.random())+65,String.fromCharCode(e)}}function d(){for(var e=[],t=0;t<4;t++)e.push(i());return e}o.innerHTML=u.join(""),s.onfocus=function(){"ac"==this.className&&(this.value="",this.className="")},s.onblur=function(){var e=this.value;/^\w{6,20}$/i.test(e)?$.ajax({method:"get",url:"http://localhost/gulp-project-template/dist/servers/users.php",data:{user:s.value},dataType:"json",async:!0,success:function(e){console.log(e),e.length?(r[0]=!1,t[0].style.display="block",t[0].innerHTML="用户名已经存在"):(r[0]=!0,t[0].style.display="none")}}):(r[0]=!1,t[0].style.display="block",t[0].innerHTML="输入格式不正确"),""==this.value&&(this.className="ac")},l.onblur=function(){var e=this.value;/^.{3,}$/.test(e)?(r[1]=!0,t[1].style.display="none"):(r[1]=!1,t[1].style.display="block")},e.onblur=function(){e.value==l.value?(r[2]=!0,t[2].style.display="none"):(r[2]=!1,t[2].style.display="block")},a.onclick=function(){u=d(),o.innerHTML=u.join("")},n.onsubmit=function(e){e=e||window.event,$.ajax({method:"POST",url:"http://localhost/gulp-project-template/dist/servers/register.php",data:{user:s.value,pwd:l.value},dataType:"json",async:!0,success:function(e){console.log(e)}});for(var t=0;t<r.length;t++){if(1==r[t]);else{if(!e.preventDefault())return!1;e.preventDefault()}var n=c.value;if(n.toLowerCase()==u.join("").toLowerCase()||n.toUpperCase()==u.join("").toUpperCase()){var o=s.value,a=l.value;document.cookie="username="+o,document.cookie="pwd="+a,window.location.href="/html/login.html"}else{if(alert("验证码错误"),!e.preventDefault())return!1;e.preventDefault()}}}};